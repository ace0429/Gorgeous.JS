/*! Gorgeous.JS v0.0.1 2015-05-13 */
var gorgeous={};!function(){"use strict";function a(a,b){var c=document.createElement("canvas");return c.width=a||0,c.height=b||0,c.getContext("2d")}function b(b){b.ctx=a(0,0),b.width=0,b.height=0,b["native"]=null,b.data=null}function c(a,b,c){a.width=b,a.height=c,a.ctx.canvas.width=b,a.ctx.canvas.height=c}function d(a,b){e(a,b.getContext("2d"))}function e(a,b){i(a,b.getImageData(0,0,b.canvas.width,b.canvas.height))}function f(a,b,c){var d=new Image;d.onload=function(){g(a,d),"function"==typeof c&&c(a)},d.src=b}function g(a,b){var d=a.ctx;c(a,b.width,b.height),d.drawImage(b,0,0,b.width,b.height),a["native"]=d.getImageData(0,0,a.width,a.height),a.data=a["native"].data}function h(a,b){var d=a.ctx;c(a,b.width,b.height),d.putImageData(b["native"],0,0),a["native"]=d.getImageData(0,0,a.width,a.height),a.data=a["native"].data}function i(a,b){var d=a.ctx;c(a,b.width,b.height),d.putImageData(b,0,0),a["native"]=d.getImageData(0,0,a.width,a.height),a.data=a["native"].data}function j(a,b,c,d,e,f){if(b=b||0,c=c||0,d=d||a.width-b,e=e||a.height-c,0>b||0>c||b>a.width||c>a.height||0>d||0>e||b+d>a.width||c+e>a.height)throw new Error("range error");for(var g=[],h=d+b,i=e+c,j=b;h>j;j++)g[j]=[];var k=a.data;g.left=b,g.top=c,g.width=d,g.height=e,g.right=b+d,g.bottom=c+e,g.each=function(a){for(var b=this.top;b<this.bottom;b++)for(var c=this.left;c<this.right;c++)a(this[c][b],c,b);return this};for(var l=c;i>l;l++)for(var m=b;h>m;m++){g[m][l]={};var n=4*(l*a.width+m);f(g[m][l],k,n)}return g}function k(a,b,c){for(var d=a.data,e=b.top;e<b.bottom;e++)for(var f=b.left;f<b.right;f++){var g=4*(e*a.width+f);c(b[f][e],d,g)}a.ctx.putImageData(a["native"],0,0),a["native"]=a.ctx.getImageData(0,0,a.width,a.height),a.data=a["native"].data}var l=gorgeous;l.ImageData=function(a,c){if(!(this instanceof l.ImageData))return new l.ImageData(a,c);if(a instanceof HTMLCanvasElement)d(this,a);else if(a instanceof CanvasRenderingContext2D)e(this,a);else if(b(this),"string"==typeof a)f(this,a,c);else if(a instanceof Image)g(this,a);else if(a instanceof l.ImageData)h(this,a);else{if(!(a instanceof ImageData))throw new Error("Need a source to create g.ImageData.");i(this,a)}},l.ImageData.prototype.getDataURL=function(){return this.ctx.canvas.toDataURL()},l.ImageData.prototype.getImage=function(a){var b=new Image;return b.onload=function(){"function"==typeof a&&a(b)},b.src=this.getDataURL(),b},l.ImageData.prototype.getSize=function(){return{w:this.width,h:this.height}},l.ImageData.prototype.getPixels=function(a,b,c,d){return j(this,a,b,c,d,function(a,b,c){a.r=b[c],a.g=b[c+1],a.b=b[c+2],a.a=b[c+3]})},l.ImageData.prototype.setPixels=function(a){k(this,a,function(a,b,c){b[c]=a.r,b[c+1]=a.g,b[c+2]=a.b,b[c+3]=a.a})},l.ImageData.prototype.getR=function(){for(var a=new l.ImageData(this),b=a.data,c=0;c<b.length;c+=4)b[c+1]=b[c+2]=0;return a.ctx.putImageData(a["native"],0,0),a},l.ImageData.prototype.getG=function(){for(var a=new l.ImageData(this),b=a.data,c=0;c<b.length;c+=4)b[c]=b[c+2]=0;return a.ctx.putImageData(a["native"],0,0),a},l.ImageData.prototype.getB=function(){for(var a=new l.ImageData(this),b=a.data,c=0;c<b.length;c+=4)b[c]=b[c+1]=0;return a.ctx.putImageData(a["native"],0,0),a},l.GrayImageData=function(a,b,c){function d(a){function b(a){for(var b={max:a[0],min:a[0]},c=1;3>c;c++)a[c]<b.min&&(b.min=a[c]),a[c]>b.max&&(b.max=a[c]);return b}for(var c=a.data,d=0;d<c.length;d+=4){var e=b([c[d],c[d+1],c[d+2]]),f=.5*(e.max+e.min);c[d]=c[d+1]=c[d+2]=f}}function e(a){if("function"==typeof b){var c=l.ImageData.prototype.getPixels.call(a);b(c),a.setPixels(c)}else d(a["native"]),a.ctx.putImageData(a["native"],0,0)}if(!(this instanceof l.GrayImageData))return new l.GrayImageData(a,b,c);if(a instanceof l.GrayImageData)l.ImageData.call(this,a);else if("string"==typeof a){var f=this;l.ImageData.call(this,a,function(){e(f),"function"==typeof c&&c(f)})}else if(a instanceof HTMLCanvasElement||a instanceof CanvasRenderingContext2D)l.GrayImageData.call(this,new l.ImageData(a),b);else{if(!(a instanceof l.ImageData||a instanceof Image||a instanceof ImageData))throw new Error("Need a source to create g.GrayImageData.");l.ImageData.call(this,a),e(this)}},l.GrayImageData.prototype=Object.create(l.ImageData.prototype),l.GrayImageData.prototype.constructor=l.GrayImageData,l.GrayImageData.prototype.getPixels=function(a,b,c,d){return j(this,a,b,c,d,function(a,b,c){a.l=b[c],a.a=b[c+3]})},l.GrayImageData.prototype.setPixels=function(a){k(this,a,function(a,b,c){b[c]=b[c+1]=b[c+2]=a.l,b[c+3]=a.a})},l.BinaryImageData=function(a,b,c){function d(a){for(var b=a.data,c=0,d=0;d<b.length;d+=4)c+=b[d];for(var e=c/b.length*4,d=0;d<b.length;d+=4)b[d]<=e?b[d]=b[d+1]=b[d+2]=0:b[d]=b[d+1]=b[d+2]=255}function e(a){if("function"==typeof b){console.log("threshold");var c=l.GrayImageData.prototype.getPixels.call(a);b(c),a.setPixels(c)}else d(a["native"]),a.ctx.putImageData(a["native"],0,0)}if(!(this instanceof l.BinaryImageData))return new l.BinaryImageData(a,b,c);if(a instanceof l.BinaryImageData)l.GrayImageData.call(this,a);else if("string"==typeof a){var f=this;l.GrayImageData.call(this,a,null,function(){e(f),"function"==typeof c&&c(f)})}else if(a instanceof HTMLCanvasElement||a instanceof CanvasRenderingContext2D)l.BinaryImageData.call(this,new l.GrayImageData(a),b);else{if(!(a instanceof l.ImageData||a instanceof Image||a instanceof ImageData))throw new Error("Need a source to create g.BinaryImageData.");l.GrayImageData.call(this,a),e(this)}},l.BinaryImageData.prototype=Object.create(l.GrayImageData.prototype),l.BinaryImageData.prototype.constructor=l.BinaryImageData,l.BinaryImageData.prototype.setPixels=function(a){k(this,a,function(a,b,c){if(255!==a.l&&0!==a.l)throw new Error("binary image only accepts 0 or 255 as lightness.");b[c]=b[c+1]=b[c+2]=a.l,b[c+3]=a.a})}}(),function(){"use strict";var a=gorgeous;a.loadImage=function(a,b){var c=new Image;return c.onload=function(a){b(c,a)},c.src=a,c}}();